---
layout: post
title: "[Javascript] this"
subtitle: "js this"
date: 2021-9-21 20:10:00
author: "dongjune"
header-img: "img/in_post/2.jpg"
catalog: true
tags:
  - JavaScript
---
# ğŸ‘ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ this
ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ `this`ëŠ” ë‹¤ë¥¸ ì–¸ì–´ì™€ëŠ” ë‹¬ë¼ í—·ê°ˆë¦¬ëŠ” ê°œë…ì…ë‹ˆë‹¤.
javaì—ì„œì˜ thisëŠ” ì¸ìŠ¤í„´ìŠ¤ê°€ ìê¸° ìì‹ ì„ ê°€ë¦¬í‚¤ëŠ” ì°¸ì¡°ë³€ìˆ˜ì…ë‹ˆë‹¤.  
í•˜ì§€ë§Œ ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ ê²½ìš° `this`ì— ë°”ì¸ë”© ë˜ëŠ” ê°ì²´ëŠ” í•¨ìˆ˜ì˜ í˜¸ì¶œ ë°©ì‹ì— ë”°ë¼ ë‹¬ë¼ì§€ê²Œ ë©ë‹ˆë‹¤.
# ğŸ‘ í•¨ìˆ˜í˜¸ì¶œ ë°©ì‹ì— ë”°ë¥¸ this ë°”ì¸ë”©
ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ thisëŠ” í•¨ìˆ˜ê°€ ì–´ë–»ê²Œ í˜¸ì¶œë˜ëŠ”ì§€ì— ë”°ë¼ ë°”ì¸ë”© í•  ê°ì²´ê°€ ë™ì ìœ¼ë¡œ ê²°ì •ë©ë‹ˆë‹¤. ì•„ë˜ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ì˜ í•¨ìˆ˜ í˜¸ì¶œë°©ì‹ì…ë‹ˆë‹¤.
1. í•¨ìˆ˜ í˜¸ì¶œ
   ```javascript
   function foo(){
     console.log(this);
   }
   foo(); // window
   ```
2. ë©”ì†Œë“œ í˜¸ì¶œ
   ```javascript
   const obj = {foo:foo};
   obj.foo(); // obj
   ```
3. ìƒì„±ì í•¨ìˆ˜ í˜¸ì¶œ
   ```javascript
   const instance = new foo(); // instance;
   ```
4. apply,call,bind í˜¸ì¶œ
   ```javascript
   const bar = {hi:'hi'};
   foo.call(bar); // bar
   foo.apply(bar); // bar
   foo.bind(bar)(); // bar
   ```

ì´ì œ ì´ 4ê°€ì§€ í•¨ìˆ˜ í˜¸ì¶œ ë°©ì‹ì— ë”°ë¼ `this`ê°€ ì–´ë–»ê²Œ ë°”ì¸ë”© ë˜ëŠ”ì§€ ìì„¸íˆ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
## ğŸ’ 1. í•¨ìˆ˜ í˜¸ì¶œ
ì „ì—­ ê°ì²´ëŠ” ëª¨ë“  ê°ì²´ì˜ ìµœìƒìœ„ ê³„ì¸µì„ ì˜ë¯¸í•©ë‹ˆë‹¤. ë¸Œë¼ìš°ì €ì—ì„œëŠ” `window`, nodeì—ì„œëŠ” `global`ì´ ì „ì—­ ê°ì²´ì…ë‹ˆë‹¤.  
ë§Œì¼ í•¨ìˆ˜ë‚˜ ë³€ìˆ˜ë¥¼ ì „ì—­ì— ì„ ì–¸í•˜ê²Œ ë˜ë©´ ê·¸ê²ƒë“¤ì€ ì „ì—­ ê°ì²´ì˜ í”„ë¡œí¼í‹°ê°€ ë©ë‹ˆë‹¤.
```jsx
const hello = 'hello';

function foo(){
  console.log('hi');
}

console.log(window.hello) // hello
window.foo() // hi
```  

âœ… ê¸°ë³¸ì ìœ¼ë¡œ ì „ì—­ í•¨ìˆ˜ì˜ `this`ëŠ” ì´ ì „ì—­ê°ì²´ì— ë°”ì¸ë”©ì´ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  ë‚´ë¶€í•¨ìˆ˜ì˜ `this`ë„ ë§ˆì°¬ê°€ì§€ë¡œ ì „ì—­ê°ì²´ì— ë°”ì¸ë”© ë©ë‹ˆë‹¤.  
```jsx
function foo(){
  console.log(this); // window
  function bar(){
    console.log(this); // window
  }
  bar();
}
foo();
```
âœ… ë‚´ë¶€í•¨ìˆ˜ëŠ” ì¼ë°˜ í•¨ìˆ˜, ë©”ì†Œë“œ, ì½œë°±í•¨ìˆ˜ ì–´ë””ì—ì„œ ì„ ì–¸ëëŠ”ì§€ì— ìƒê´€ì—†ì´ í•­ìƒ ì „ì—­ê°ì²´ì— `this`ê°€ ë°”ì¸ë”© ë˜ê²Œ ë©ë‹ˆë‹¤.
## ğŸ’ 2. ë©”ì†Œë“œ í˜¸ì¶œ
í•¨ìˆ˜ê°€ ê°ì²´ì˜ í”„ë¡œí¼í‹°ê°€ ë˜ë©´ ì´ê²ƒì„ ë©”ì†Œë“œë¼ê³  ë¶€ë¦…ë‹ˆë‹¤. ì´ë•Œ ë©”ì†Œë“œ ë‚´ë¶€ì˜ `this`ëŠ” í•´ë‹¹ ë©”ì†Œë“œë¥¼ ì†Œìœ í•œ ê°ì²´, ì¦‰ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œ ê°ì²´ì™€ ë°”ì¸ë”© ë©ë‹ˆë‹¤.
```jsx
const obj = {
  name: 'dongjune',
  hi:function(){
    console.log('hi' + this.name);
  }
}

obj.hi(); // hi dongjune
```
í”„ë¡œí† íƒ€ì… ê°ì²´ë„ ë©”ì†Œë“œë¥¼ ê°€ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. í”„ë¡œí† íƒ€ì…ì—ì„œë„ ë§ˆì°¬ê°€ì§€ë¡œ `this`ëŠ” ê·¸ ë©”ì†Œë“œë¥¼ í˜¸ì¶œí•œ ê°ì²´ì— ë°”ì¸ë”© ë©ë‹ˆë‹¤.
```jsx
function Person(name) {
  this.name = name;
}

Person.prototype.getName = function() {
  return this.name;
}

const me = new Person('Lee');
console.log(me.getName()); // Lee

Person.prototype.name = 'Kim';
console.log(Person.prototype.getName()); // Kim
```
## ğŸ’ 3. ìƒì„±ì í•¨ìˆ˜ í˜¸ì¶œ
ìƒì„±ì í•¨ìˆ˜ë¥¼ í†µí•´ ê°ì²´ë¥¼ ìƒì„±í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë‹¤ë¥¸ ì–¸ì–´ì™€ëŠ” ë‹¤ë¥´ê²Œ ê¸°ì¡´ í•¨ìˆ˜ì— `new` í‚¤ì›Œë“œë¥¼ ë¶™ì´ë©´ í•´ë‹¹ í•¨ìˆ˜ê°€ ìƒì„±ì í•¨ìˆ˜ë¡œ ë™ì‘í•˜ê²Œ ë©ë‹ˆë‹¤.
```jsx
// ìƒì„±ì í•¨ìˆ˜
function Person(name) {
  this.name = name;
}

const me = new Person('Lee');
console.log(me); // {name: "Lee"}

// new ì—°ì‚°ìì™€ í•¨ê»˜ ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì§€ ì•Šìœ¼ë©´ ìƒì„±ì í•¨ìˆ˜ë¡œ ë™ì‘í•˜ì§€ ì•ŠëŠ”ë‹¤.
const you = Person('Kim');
console.log(you); // undefined
```

`new` ì—°ì‚°ìë¡œ ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ê²Œ ë˜ë©´ ì•ì„œ ì‚´í´ë³¸ ë©”ì†Œë“œë‚˜ í•¨ìˆ˜ í˜¸ì¶œë•Œì™€ëŠ” `this` ë°”ì¸ë”©ì´ ë‹¤ë¥´ê²Œ ë™ì‘í•©ë‹ˆë‹¤.
### ğŸŒ± 3.1. ìƒì„±ì í•¨ìˆ˜ ë™ì‘ ë°©ì‹
new ì—°ì‚°ìë¡œ ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ë©´ ë‹¤ìŒì˜ ê³¼ì •ì„ ê±°ì¹˜ê²Œ ë©ë‹ˆë‹¤.
1. ë¹ˆ ê°ì²´ ìƒì„± ë° `this` ë°”ì¸ë”©
   - ìƒì„±ì í•¨ìˆ˜ì˜ ì½”ë“œ ì‹¤í–‰ ì „ì— ë¹ˆ ê°ì²´ê°€ ìƒì„±ëœë‹¤.
   - ìƒì„±ì í•¨ìˆ˜ ë‚´ì—ì„œ ì‚¬ìš©í•˜ëŠ” `this`ëŠ” ì´ ë¹ˆ ê°ì²´ë¥¼ ê°€ë¦¬í‚´
   - ê·¸ë ‡ê²Œ ìƒì„± ëœ ë¹ˆ ê°ì²´ëŠ” ìƒì„±ì í•¨ìˆ˜ì˜ `prototype` í”„ë¡œí¼í‹°ê°€ ê°€ë¦¬í‚¤ëŠ” ê°ì²´ë¥¼ ìì‹ ì˜ í”„ë¡œí† íƒ€ì… ê°ì²´ë¡œ ì„¤ì •í•œë‹¤.
2. `this`ë¥¼ í†µí•œ í”„ë¡œí¼í‹° ìƒì„±
   - ìƒì„±ëœ ë¹ˆ ê°ì²´ì— `this`ë¥¼ í†µí•´ ë™ì ìœ¼ë¡œ í”„ë¡œí¼í‹°ë‚˜ ë©”ì†Œë“œë¥¼ í• ë‹¹í•œë‹¤.
3. ìƒì„±ëœ ê°ì²´ ë°˜í™˜
   - ë°˜í™˜ë¬¸ì´ ì—†ëŠ” ê²½ìš° `this`ì— ë°”ì¸ë”© ëœ ìƒˆë¡œ ìƒì„±í•œ ê°ì²´ë¥¼ ë°˜í™˜í•œë‹¤. ëª…ì‹œì ìœ¼ë¡œ `this`ë¥¼ ë°˜í™˜í•˜ì—¬ë„ ê°™ì€ ê²°ê³¼ì´ë‹¤.

```jsx
function Person(name) {
  // ìƒì„±ì í•¨ìˆ˜ ì½”ë“œ ì‹¤í–‰ ì „ -------- 1
  this.name = name;  // --------- 2
  // ìƒì„±ëœ í•¨ìˆ˜ ë°˜í™˜ -------------- 3
}

const me = new Person('Lee');
console.log(me.name);
```
### ğŸŒ± 3.2. ìƒì„±ì í•¨ìˆ˜ì— new ì—°ì‚°ìë¥¼ ë¶™ì´ì§€ ì•ŠëŠ” ê²½ìš°
ìƒì„±ì í•¨ìˆ˜ë¥¼ `new` ì—†ì´ í˜¸ì¶œí•œ ê²½ìš° í•¨ìˆ˜ ë‚´ë¶€ì˜ `this`ëŠ” ì „ì—­ ê°ì²´ì— ë°”ì¸ë”© ë©ë‹ˆë‹¤. ë˜í•œ ì•”ë¬µì ìœ¼ë¡œ ìƒì„±í•œ ë¹… ê°ì²´ë¥¼ ë°˜í™˜í•´ì£¼ì§€ ì•Šê¸° ë•Œë¬¸ì— ì•„ë˜ì˜ ì˜ˆì œì—ì„œ `me`ëŠ” `undefined`ê°€ ë©ë‹ˆë‹¤.
```jsx
function Person(name) {
  // newì—†ì´ í˜¸ì¶œí•˜ëŠ” ê²½ìš°, ì „ì—­ê°ì²´ì— name í”„ë¡œí¼í‹°ë¥¼ ì¶”ê°€
  this.name = name;
};

// ì¼ë°˜ í•¨ìˆ˜ë¡œì„œ í˜¸ì¶œë˜ì—ˆê¸° ë•Œë¬¸ì— ê°ì²´ë¥¼ ì•”ë¬µì ìœ¼ë¡œ ìƒì„±í•˜ì—¬ ë°˜í™˜í•˜ì§€ ì•ŠëŠ”ë‹¤.
// ì¼ë°˜ í•¨ìˆ˜ì˜ thisëŠ” ì „ì—­ê°ì²´ë¥¼ ê°€ë¦¬í‚¨ë‹¤.
var me = Person('Kim');

console.log(me); // undefined
console.log(window.name); // Kim
```
ìœ„ì™€ ê°™ì´ ìƒì„±ì í•¨ìˆ˜ì— `new`ë¥¼ ë¶™ì´ì§€ ì•Šì•„ ë°œìƒí•˜ëŠ” ì˜¤ë¥˜ë“¤ì´ ìˆìŠµë‹ˆë‹¤. ë³´í†µ ìƒì„±ì í•¨ìˆ˜ëŠ” ì²«ë¬¸ìë¥¼ ëŒ€ë¬¸ìë¡œ í•˜ì—¬ ì¼ë°˜ í•¨ìˆ˜ì™€ êµ¬ë¶„í•˜ê³  ìˆì§€ë§Œ ê·¸ëŸ¼ì—ë„ ì‹¤ìˆ˜ë¥¼ ë°©ì§€í•˜ê¸°ëŠ” ì–´ë µìŠµë‹ˆë‹¤.  
ê·¸ë˜ì„œ ì´ëŸ¬í•œ ìœ„í—˜ì„±ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ `Scope-Safe Constructor` íŒ¨í„´ì´ ìˆìŠµë‹ˆë‹¤. ì´ íŒ¨í„´ì€ ëŒ€ë¶€ë¶„ì˜ ë¼ì´ë¸ŒëŸ¬ë¦¬ì—ì„œ ê´‘ë²”ìœ„í•˜ê²Œ ì‚¬ìš©ëœë‹¤ê³  í•©ë‹ˆë‹¤.  
```jsx
// Scope-Safe Constructor Pattern
function A(arg) {
  // ìƒì„±ì í•¨ìˆ˜ê°€ new ì—°ì‚°ìì™€ í•¨ê»˜ í˜¸ì¶œë˜ë©´ í•¨ìˆ˜ì˜ ì„ ë‘ì—ì„œ ë¹ˆê°ì²´ë¥¼ ìƒì„±í•˜ê³  thisì— ë°”ì¸ë”©í•œë‹¤.

  /*
  thisê°€ í˜¸ì¶œëœ í•¨ìˆ˜(arguments.callee, ë³¸ ì˜ˆì œì˜ ê²½ìš° A)ì˜ ì¸ìŠ¤í„´ìŠ¤ê°€ ì•„ë‹ˆë©´
  new ì—°ì‚°ìë¥¼ ì‚¬ìš©í•˜ì§€ ì•Šì€ ê²ƒì´ë¯€ë¡œ ì´ ê²½ìš° newì™€ í•¨ê»˜ ìƒì„±ì í•¨ìˆ˜ë¥¼ í˜¸ì¶œí•˜ì—¬ 
  ì¸ìŠ¤í„´ìŠ¤ë¥¼ ë°˜í™˜í•œë‹¤.
  arguments.calleeëŠ” í˜¸ì¶œëœ í•¨ìˆ˜ì˜ ì´ë¦„ì„ ë‚˜íƒ€ë‚¸ë‹¤. ì´ ì˜ˆì œì˜ ê²½ìš° Aë¡œ í‘œê¸°í•˜ì—¬ë„ 
  ë¬¸ì œì—†ì´ ë™ì‘í•˜ì§€ë§Œ íŠ¹ì •í•¨ìˆ˜ì˜ ì´ë¦„ê³¼ ì˜ì¡´ì„±ì„ ì—†ì• ê¸° ìœ„í•´ì„œ arguments.calleeë¥¼ 
  ì‚¬ìš©í•˜ëŠ” ê²ƒì´ ì¢‹ë‹¤.
  */
  if (!(this instanceof arguments.callee)) {
    return new arguments.callee(arg);
  }

  // í”„ë¡œí¼í‹° ìƒì„±ê³¼ ê°’ì˜ í• ë‹¹
  this.value = arg ? arg : 0;
}

var a = new A(100);
var b = A(10);

console.log(a.value); // 100
console.log(b.value); // 10
```
## ğŸ’ 4. apply,call,bind í˜¸ì¶œ
thisì— ë°”ì¸ë”© ë  ê°ì²´ëŠ” ìë°”ìŠ¤í¬ë¦½íŠ¸ ì—”ì§„ì´ ì•”ë¬µì ìœ¼ë¡œ ìˆ˜í–‰í•´ì¤ë‹ˆë‹¤.  
í•˜ì§€ë§Œ `apply, call, bind` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ë©´ ëª…ì‹œì ìœ¼ë¡œ thisë¥¼ ë°”ì¸ë”© í•  ìˆ˜ ìˆëŠ”ìŠµë‹ˆë‹¤.  
> apply, call, bindëŠ” Function.prototypeì˜ ë©”ì†Œë“œì´ë‹¤.

```jsx
Person.apply(foo, [1, 2, 3]);

Person.call(foo, 1, 2, 3);

Person.bind(foo)(1,2,3);
```
ì´ ë©”ì†Œë“œë“¤ì€ ì½œë°± í•¨ìˆ˜ì˜ `this`ë¥¼ ìœ„í•´ì„œë„ ì‚¬ìš©ë©ë‹ˆë‹¤.
```jsx
function Person(name) {
  this.name = name;
}

Person.prototype.doSomething = function(callback) {
  if(typeof callback == 'function') {
    // --------- 1
    callback();
  }
};

function foo() {
  console.log(this.name); // --------- 2
}

var p = new Person('Lee');
p.doSomething(foo);  // undefined
```
1 ì‹œì ì—ì„œ `this`ëŠ” `Person` ê°ì²´ì…ë‹ˆë‹¤. ê·¸ëŸ¬ë‚˜ 2 ì‹œì ì—ì„œ `this`ëŠ” ì „ì—­ ê°ì²´ì…ë‹ˆë‹¤. ë‹¤ìŒê³¼ ê°™ì´ `call, apply, bind` ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì—¬ thisë¥¼ ì¼ì¹˜ì‹œí‚¬ ìˆ˜ ìˆìŠµë‹ˆë‹¤.
### call
```jsx
Person.prototype.doSomething = function(callback) {
  if(typeof callback == 'function') {
    // --------- 1
    callback.call(this);
  }
};
```
### apply
```jsx
Person.prototype.doSomething = function(callback) {
  if(typeof callback == 'function') {
    // --------- 1
    callback.apply(this);
  }
};
```
### bind
`bind`ëŠ” `this`ê°€ ë°”ì¸ë”© ëœ ìƒˆë¡œìš´ í•¨ìˆ˜ë¥¼ ë¦¬í„´í•©ë‹ˆë‹¤.
```jsx
Person.prototype.doSomething = function(callback) {
  if(typeof callback == 'function') {
    // --------- 1
    callback.bind(this)();
  }
};
```