---
layout: post
title: "[React] useCallbackê³¼ React.memo"
subtitle: "React, useCallback, memo"
date: 2021-11-14 22:20:00
author: "dongjune"
header-img: "img/in_post/4.jpg"
catalog: true
tags:
  - React
---
# ğŸ›« Intro
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œëŠ” ë¦¬ì•¡íŠ¸ì˜ ìµœì í™” ê¸°ë²• ì¤‘ `useCallback`ê³¼ `memo`ì— ëŒ€í•´ì„œ ì•Œì•„ë³´ë„ë¡ í•˜ê² ìŠµë‹ˆë‹¤.  
ë¦¬ì•¡íŠ¸ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ëœë”ë§ ë  ë•Œë§ˆë‹¤ ê·¸ ì•ˆì— ì„ ì–¸ ëœ í•¨ìˆ˜ë“¤ì€ ë§¤ë²ˆ ì¬ìƒì„± ë˜ê²Œ ë©ë‹ˆë‹¤. ì´ë•Œ `useCallback`ì„ ì‚¬ìš©í•˜ë©´ í•¨ìˆ˜ì˜ ì°¸ì¡° ê°’ì„ ìœ ì§€í•´ì¤„ ìˆ˜ ìˆìŠµë‹ˆë‹¤!  
ì½”ë“œë¥¼ ì‚´í´ë³´ë©° ì œëŒ€ë¡œ ì´í•´í•˜ê¸° ì „ì— ìš°ì„  ë¦¬ì•¡íŠ¸ê°€ ì–¸ì œ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ëŠ”ì§€ í™•ì‹¤íˆ ì•Œê³  ê°ˆ í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤! 

# ReactëŠ” ì–¸ì œ ë¦¬ëœë”ë§ ë ê¹Œ?
ë¦¬ì•¡íŠ¸ëŠ” ë‹¤ìŒì˜ 5ê°€ì§€ ê²½ìš°ì—ì„œ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚©ë‹ˆë‹¤.
1. stateê°€ ë³€ê²½ë  ë•Œ
2. ìƒˆë¡œìš´ propsê°€ ë“¤ì–´ì˜¬ ë•Œ
3. ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ê°€ ë¦¬ëœë”ë§ ë  ë•Œ
4. shouldComponentUpdateì—ì„œ trueê°€ ë°˜í™˜ë  ë•Œ
5. forceUpdateê°€ ì‹¤í–‰ë  ë•Œ

> 1, 2ë²ˆì˜ ê²½ìš° ë¦¬ì•¡íŠ¸ëŠ” ê¸°ë³¸ì ìœ¼ë¡œ ì–•ì€ ë¹„êµë¥¼ í†µí•´ ê°’ì„ ë¹„êµí•©ë‹ˆë‹¤.  
state ê°’ì— pushë‚˜ pop ë“±ì˜ ì›ë³¸ì„ ë³€ê²½í•˜ëŠ” ë©”ì†Œë“œë¥¼ ì‚¬ìš©í•˜ì§€ ë§ì•„ì•¼ í•˜ëŠ” ì´ìœ ëŠ” ë¦¬ì•¡íŠ¸ëŠ” ì–•ì€ ë³µì‚¬ë¥¼ í†µí•´ ê°’ì˜ ë³€ê²½ì„ íŒë‹¨í•˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤. ì›ë³¸ì„ ë³€ê²½í•œë‹¤ í•´ë„ ì°¸ì¡° ê°’ì€ ê·¸ëŒ€ë¡œì´ê¸° ë•Œë¬¸ì— ë¦¬ëœë”ë§ì€ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤.  

# ë¶ˆí•„ìš”í•œ ë¦¬ëœë”ë§
ë¶€ëª¨ ì»´í¬ë„ŒíŠ¸ì˜ ë³€ê²½ìœ¼ë¡œ ì¸í•´ ìì‹ ì»´í¬ë„ŒíŠ¸ë“¤ë„ ì „ë¶€ ëœë”ë§ ë˜ëŠ” ê²½ìš°ë¥¼ ìƒê°í•´ë´…ì‹œë‹¤. ì´ë•Œ ìì‹ ì»´í¬ë„ŒíŠ¸ëŠ” ì•„ë¬´ëŸ° ë³€ê²½ì´ ì—†ì–´ë„ ë¦¬ì•¡íŠ¸ëŠ” ë¦¬ëœë”ë§ ë˜ëŠ” ì»´í¬ë„ŒíŠ¸ì˜ ìì‹ ì»´í¬ë„ŒíŠ¸ë“¤ê¹Œì§€ ì „ë¶€ ë¦¬ëœë”ë§ ì‹œí‚µë‹ˆë‹¤.  
ì•„ë˜ì˜ ì½”ë“œëŠ” ê·¸ ì˜ˆì‹œì…ë‹ˆë‹¤. `Parent` ì»´í¬ë„ŒíŠ¸ì˜ `count` ìƒíƒœê°€ ë³€ê²½ ë˜ì–´ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ë©´ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ì¸ Child ì»´í¬ë„ŒíŠ¸ë“¤ë„ ëª¨ë‘ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ê²Œ ë©ë‹ˆë‹¤.
```jsx
import { useState } from "react";

export default function Parent() {
  const [player, setPlayer] = useState("Messi");
  const handleOnClick = (e) => {
    setPlayer(e.target.textContent);
  };
  return (
    <div>
      <h1>{player} is the best player!</h1>
      <Child onClick={handleOnClick} player={"Messi"} />
      <Child onClick={handleOnClick} player={"Ronaldo"} />
      <Child onClick={handleOnClick} player={"Son"} />
    </div>
  );
}

const Child = ({ onClick, player }) => {
  return <button onClick={onClick}>{player}</button>;
};
```
profilerë¡œ í™•ì¸í•´ë³´ë©´ Parentì™€ 3ê°œì˜ Child ì»´í¬ë„ŒíŠ¸ ëª¨ë‘ ë¦¬ëœë”ë§ ë˜ëŠ” ê²ƒì„ ë³¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤. ë Œë”ë§ ì‹œê°„ì€ ì´ 3.4ms ë§Œí¼ ê±¸ë¦¬ë„¤ìš”.
![1](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/2ae4d667-c27e-4718-8ccd-276f65f13481/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-11-14_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_11.19.59.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211114T142012Z&X-Amz-Expires=86400&X-Amz-Signature=0e0ad11ccb656e3c07aa3edb59ede4976fc35773109496f47f8db27e28732d7a&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA%25202021-11-14%2520%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE%252011.19.59.png%22)

# React.memoë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ë©”ëª¨ì´ì œì´ì…˜í•˜ì!
`React.memo`ë¥¼ ì‚¬ìš©í•˜ì—¬ ìì‹ ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ë¶ˆí•„ìš”í•œ ë¦¬ëœë”ë§ì„ ë§‰ì„ ìˆ˜ ìˆìŠµë‹ˆë‹¤. `React.memo`ë¡œ ê°ì‹¸ì§„ ì»´í¬ë„ŒíŠ¸ëŠ” ë“¤ì–´ì˜¤ëŠ” `props`ì˜ ë³€ê²½ì´ ì—†ìœ¼ë©´ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤. ì´ë•Œ ì£¼ì˜í•  ì ì€ `React.memo`ëŠ” `props`ì—ë§Œ ì˜í–¥ì„ ì¤€ë‹¤ëŠ” ì‚¬ì‹¤ì…ë‹ˆë‹¤. `useContext`ë‚˜ `useState`ì—ì„œ ìƒíƒœ ê°’ì˜ ë³€ê²½ì´ ì¼ì–´ë‚˜ë©´ `React.memo`ë¡œ ë©”ëª¨ì´ì œì´ì…˜ í•œ ì»´í¬ë„ŒíŠ¸ë„ ì—¬ì „íˆ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ê²Œ ë©ë‹ˆë‹¤.  
ë˜ í•œê°€ì§€ ì£¼ì˜í•  ì ì€ `React.memo`ë¥¼ ì‚¬ìš©í•˜ëŠ” ì»´í¬ë„ŒíŠ¸ëŠ” ë™ì¼í•œ `props`ì¼ë•Œ ë™ì¼í•œ ëœë”ë§ ê²°ê³¼ë¥¼ ë¦¬í„´í•´ì•¼ í•©ë‹ˆë‹¤.  
ì´ì œ ìœ„ì˜ ì½”ë“œì—ì„œ `Child` ì»´í¬ë„ŒíŠ¸ë¥¼ `React.memo`ë¡œ ê°ì‹¸ë³´ê² ìŠµë‹ˆë‹¤.  
```jsx
const Child = React.memo(() => {
  return <div>Child</div>;
});
```
ê·¸ ë‹¤ìŒ profilerë¥¼ ì‚¬ìš©í•˜ì—¬ ëœë”ë§ì„ ì¸¡ì •í•´ë³´ê² ìŠµë‹ˆë‹¤.  
`Parent` ì»´í¬ë„ŒíŠ¸ í•˜ë‚˜ë§Œ ëœë”ë§ ë˜ëŠ”ê²ƒì´ ë³´ì´ì‹œë‚˜ìš”? ëœë”ë§ ì‹œê°„ë„ 1msë¡œ ì „ë³´ë‹¤ ë¬´ë ¤ 3ë°°ì´ìƒ ë¹¨ë¼ì¡ŒìŠµë‹ˆë‹¤!
![2](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/ce79895a-ea8a-49d7-a3e4-10298bd169b9/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-11-14_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_11.26.18.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211114T142627Z&X-Amz-Expires=86400&X-Amz-Signature=533819acdd5d354dd3cbe8937c0541d5474db7089262a29145a0d32b7bc96bbc&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA%25202021-11-14%2520%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE%252011.26.18.png%22)

# í•¨ìˆ˜ë¥¼ propsë¡œ ë„˜ê²¨ì£¼ëŠ” ê²½ìš°
ê·¸ë ‡ë‹¤ë©´ `React.memo`ë¡œ ë©”ëª¨ì´ì œì´ì…˜ ëœ í•˜ìœ„ ì»´í¬ë„ŒíŠ¸ë“¤ì—ê²Œ í•¨ìˆ˜ë¥¼ `props`ë¡œ ë„˜ê²¨ì£¼ëŠ” ê²½ìš°ëŠ” ì–´ë–¨ê¹Œìš”? ì•„ë˜ì˜ ì½”ë“œë¥¼ ì‚´í´ë³´ê² ìŠµë‹ˆë‹¤.
```jsx
import React, { useState } from "react";

export default function Parent() {
  const [isClicked, setIsClicked] = useState(false);
  const handleOnClick = () => {
    setIsClicked(true);
  };
  return (
    <div>
      <h1>{isClicked ? "true" : "false"}</h1>
      <Child onClick={handleOnClick} />
      <Child onClick={handleOnClick} />
      <Child onClick={handleOnClick} />
    </div>
  );
}

const Child = React.memo(({ onClick }) => {
  return <button onClick={onClick}>Click me!</button>;
});

```
`Child`ë¥¼ ë©”ëª¨ì´ì œì´ì…˜ í–ˆìœ¼ë‹ˆ `Child`ë“¤ì€ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•Šì„ê¹Œìš”?
profilerë¥¼ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.
![3](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/2157c70b-6094-44fd-8f2c-e01e6754649c/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-11-14_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_11.51.23.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211114T145132Z&X-Amz-Expires=86400&X-Amz-Signature=3df329d3d9615ebd42c9c7361f843a979b8dbafaadb973ef661eb66c9856ae48&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA%25202021-11-14%2520%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE%252011.51.23.png%22)
ì—¬ì „íˆ `Child` ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ê³  ìˆìŠµë‹ˆë‹¤. ì–´ë–»ê²Œ ëœ ê±¸ê¹Œìš”?  
ê·¸ê²ƒì€ `props`ë¡œ ë„˜ê²¨ì£¼ëŠ” `handleOnClick` í•¨ìˆ˜ê°€ Parent ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ëœë”ë§ ë§ˆë‹¤ ë³€ê²½ë˜ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤!  
ê¸°ë³¸ì ìœ¼ë¡œ ì»´í¬ë„ŒíŠ¸ì˜ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ë©´ ê·¸ ì•ˆì—ì„œ ì„ ì–¸ëœ í•¨ìˆ˜ë“¤ì€ ëª¨ë‘ ì¬ìƒì„± ë˜ë©´ì„œ ì°¸ì¡° ê°’ì´ ë³€í•˜ê²Œ ë©ë‹ˆë‹¤. ë¦¬ì•¡íŠ¸ëŠ” ì°¸ì¡°ê°’ì„ í†µí•´ `props`ë¥¼ ë¹„êµí•˜ê¸° ë•Œë¬¸ì— `Child`ì˜ `props`ê°€ ë³€ê²½ëë‹¤ê³  ë³´ê³  `Child` ì»´í¬ë„ŒíŠ¸ë“¤ì„ ë¦¬ëœë”ë§ ì‹œí‚¤ëŠ” ê²ƒì…ë‹ˆë‹¤.

# useCallbackìœ¼ë¡œ í•¨ìˆ˜ì˜ ì°¸ì¡°ê°’ì„ ìœ ì§€í•˜ì
ìœ„ì˜ ìƒí™©ì„ `useCallback`ìœ¼ë¡œ í•´ê²°í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
ì‚¬ìš©ë²•ì€ `useEffect`ì™€ ë¹„ìŠ·í•©ë‹ˆë‹¤. ì²«ë²ˆì§¸ ì¸ìë¡œ ë©”ëª¨ì´ì œì´ì…˜ì„ ìˆ˜í–‰í•  `callback` í•¨ìˆ˜ë¥¼ ë„£ì–´ì£¼ê³  ë‘ë²ˆì§¸ ì¸ìë¡œ ì˜ì¡´ê°’ì„ ë„£ì–´ì¤ë‹ˆë‹¤.  
```jsx
const handleOnClick = useCallback(() => {
    setIsClicked(true);
}, []);
```
ìœ„ì™€ ê°™ì€ ê²½ìš° ì˜ì¡´ê°’ì„ ë¹ˆë°°ì—´ë¡œ ì„¤ì •í–ˆê¸° ë•Œë¬¸ì— `handleOnClick` í•¨ìˆ˜ëŠ” `Parent` ì»´í¬ë„ŒíŠ¸ê°€ ì²˜ìŒ ëœë”ë§ ë  ë•Œì˜ ì°¸ì¡°ê°’ì„ ìœ ì§€í•˜ê²Œ ë©ë‹ˆë‹¤.  
ì´ì œ `Profiler`ë¡œ í™•ì¸í•´ë³´ê² ìŠµë‹ˆë‹¤.
![4](https://s3.us-west-2.amazonaws.com/secure.notion-static.com/8942973c-4362-44c4-8ec2-532993b75553/%E1%84%89%E1%85%B3%E1%84%8F%E1%85%B3%E1%84%85%E1%85%B5%E1%86%AB%E1%84%89%E1%85%A3%E1%86%BA_2021-11-14_%E1%84%8B%E1%85%A9%E1%84%92%E1%85%AE_11.55.54.png?X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Credential=AKIAT73L2G45EIPT3X45%2F20211114%2Fus-west-2%2Fs3%2Faws4_request&X-Amz-Date=20211114T145610Z&X-Amz-Expires=86400&X-Amz-Signature=a2528ec225a97fe7cebccd0a14d8038ccf30bffbf81e312782ddf61dd0a55f56&X-Amz-SignedHeaders=host&response-content-disposition=filename%20%3D%22%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA%25202021-11-14%2520%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE%252011.55.54.png%22)  
ë³´ì‹œëŠ”ê²ƒê³¼ ê°™ì´ `Child` ì»´í¬ë„ŒíŠ¸ë“¤ì˜ ë¦¬ëœë”ë§ì´ ì¼ì–´ë‚˜ì§€ ì•Šê²Œ ë©ë‹ˆë‹¤. ëœë”ë§ ì‹œê°„ë„ 1.3ms ë¹¨ë¼ì¡Œë„¤ìš”.

# ğŸš€ Conclusion
ì´ë²ˆ í¬ìŠ¤íŒ…ì—ì„œ useCallbackê³¼ React.memoì— ëŒ€í•´ì„œ ì•Œì•„ë´¤ìŠµë‹ˆë‹¤.  
ì‚¬ì‹¤ í•´ë‹¹ ìµœì í™” ê¸°ë²•ë“¤ì„ ë¬´ì‘ì • ë„ì…í•˜ëŠ” ê²ƒì€ ì¢‹ì€ ë°©ë²•ì´ ì•„ë‹™ë‹ˆë‹¤. useCallbackê³¼ memoëŠ” ì¶”ê°€ì ì¸ ë¹„êµ ì—°ì‚°ë“¤ì„ ìˆ˜í–‰í•˜ê¸° ë•Œë¬¸ì— í•´ë‹¹ hookì„ ì‚¬ìš©í•´ë„ ì„±ëŠ¥ ì°¨ì´ê°€ ë³„ë¡œ ë‚˜ì§€ ì•Šê±°ë‚˜ ìµœì•…ì˜ ê²½ìš° ì„±ëŠ¥ì´ ë” ì•ˆì¢‹ì•„ì§ˆ ìˆ˜ë„ ìˆìŠµë‹ˆë‹¤.  
ë”°ë¼ì„œ ì´ëŸ¬í•œ ìµœì í™”ë¥¼ ë„ì…í•  ë•ŒëŠ” react devtoolì˜ profilerë¥¼ ì‚¬ìš©í•˜ì—¬ ì„±ëŠ¥ ê²€ì‚¬ì™€ í•¨ê»˜ ìˆ˜í–‰í•˜ëŠ” ê²ƒì´ ì¢‹ìŠµë‹ˆë‹¤.
# Reference